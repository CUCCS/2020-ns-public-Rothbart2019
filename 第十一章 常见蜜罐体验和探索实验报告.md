# 第十一章 常见蜜罐体验和探索实验报告
## 1.实验环境搭建过程
### 1.1VMware网络环境配置
![点击NAT设置，设置如下](1.11.png)
![点击DHCP设置，设置如下](1.12.png)
### 1.2攻击机配置
![选择虚拟机攻击机，设置如下](1.21.png)
![进入虚拟机攻击机，通过windows+r调出运行，输入cmd调出命令行输入ipconfig，可以看出攻击机ip地址为192.168.200.2](1.22.png)
### 1.3靶机配置
![选择VM_Win2kServer_SP0_target作为windows系统靶机，设置如下，选择仅主机模式](1.31.png)
![进入靶机，进入系统打开网上邻居，右键单击本地连接，选择属性，选择Internet协议，配置靶机的ip和网关，配置如下](1.32.png)
### 1.4安装蜜网网关虚拟机
![蜜网网关虚拟机安装完毕](1.41.png)
![蜜网网关软件安装完毕，进入登录界面，通过su -命令，提升权限至root](1.42.png)
![蜜网网关初始配置界面](!1.43.png)
![蜜罐 IP 信息配置，空格分隔多个 IP 地址](!1.44.png)
### 1.5蜜网网关管理配置
![蜜网网关配置主界面，选择 4 HoneyWall Configuration](1.51.png)
![设置管理口的 IP 地址](1.52.png)
![选择 2 Management Netmask，管理口 IP 地址的掩码](1.53.png)
![选择 3 Management Gateway](1.54.png)
![设置可以管理蜜网网关的远程控制端 IP 范围，以 CIDR 格式填写，可有多个 IP 网段，中间用空格分隔](1.55.png)
![Sebek 数据包处理选项选择为 Drop](1.56.png)
### 1.6测试网络连接
![在攻击机虚拟机ping靶机，收到回复，表示连通](1.61.png)
![在蜜网网关上监听 ICMP ping 包是否通过外网口和内网口，此操作需要root权限，攻击机发出请求，靶机回复或者靶机请求，攻击机回复，表示两者连通良好](1.62.png)
![在攻击机安装vmware tools，以便与主机之间移动文件，打开nmap，输入靶机ip地址，可以看到靶机开放了以下端口，通过端口漏洞可以进行攻击](1.62.png)
![通过远程管理蜜网网关，下载并打开pacp文件可以看到Ping的详细信息](1.64.png)
### 1.7解压缩SEEDUbuntu，在虚拟机打开
![进入系统，账号密码为seed\dees，提权为root的命令为su -，输入密码即可进入root权限，首先ifconfig命令发现系统ip为192.168.200.5，ping靶机](1.71.png)
![linux系统攻击机选择kali，kali系统自带一系列攻击软件，比如nmap，burp，msf等热门攻击软件，kali直接打开nmap，输入nmap ip即可使用nmap进行扫描，开始信息收集，为攻击做准备](1.72.png)
### 1.8渗透攻击测试
![使用kali的metasploit,输入针对 MS03-026 即插即用服务漏洞的渗透攻击命令，获得反向的 shell](1.8.png)
## 2.问题与解决
### 问题1：在安装蜜网网关虚拟机时，按照教程把iso文件直接放入，结果由于版本较早会执行简易安装，之后会遇到无法安装蜜网网关软件问题
#### 解决：新建虚拟机时，不直接放入iso文件，而是在虚拟机安装完成之后在设置中加入iso文件，不仅安装完整，并且直接出现安装蜜网网关软件，不用输入命令调出安装软件界面。
### 问题2：2020版本的kali，在终端输入apt-get update && upgrade会碰到错误
#### 解决：2020版本的kali对于以往版本用户来说比较坑，直接下载vm文件时，默认用户密码为kali\kali，不是root账户，需要sudo passwd root命令设置root密码(用惯了root，会忽略，困惑了一会儿，之后才发现没root)，登录为root权限时，apt-get update && upgrade不会再报错，kali官方源比较慢，因此一般会换软件源，通过vim /etc/apt/sources.list更换软件源，之后再更新会加快速度。
### 问题3：远程管理蜜网网关时，显示不清
#### 解决：怀疑是没有安装sebek导致，因此在csdn找到sebek下载到本地，由于windows靶机安装vmtools出错，因此选择共享文件夹形式将sebek拷贝到虚拟机
![sebek设置过程](2.3.png)
## 3.总结
### 一个基础的网络攻防实验环境至少需要：
#### a.靶机：包含系统和应用程序安全漏洞，并作为攻击目标的主机。
#### b.攻击机：安装一些专用的攻击软件，用于发起网络攻击的主机。Linux更适合作为攻击机平台。
#### c.攻击监测、分析和防御平台：最佳位置是靶机的网关，可以基于Linux操作系统构建网关主机，并通过集成各种软件使其具备网络攻击监测、分析与防御的功能。
#### d.网络连接：通过网络将靶机、攻击机和具备检测分析防御功能的网关进行连接。
### 密网：通过构建部署陷阱网络进行诱骗与分析网络攻击的一种技术手段。
### 密网网关：透明网关的攻击行为捕获与分析平台，并在蜜罐主机上通过Sebek软件记录系统攻击行为。
### 虚拟密网：蜜网架构基于虚拟机技术在单一主机上进行部署。在陷阱网络中部署靶机作为攻击目标，利用密网网关作为网络攻击监测、分析与防御平台，并在网关外网口虚拟攻击网段和攻击机，从而构成个人版的虚拟化网络攻防实验环境。